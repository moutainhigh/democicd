<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.uwallet.pay.main.dao.AdminDAO">

    <resultMap id="adminMap" type="com.uwallet.pay.main.model.entity.Admin">
        <id property="id" jdbcType="BIGINT" column="id"/>
        <result property="userName" jdbcType="VARCHAR" column="user_name"/>
        <result property="realName" jdbcType="VARCHAR" column="real_name"/>
        <result property="password" jdbcType="VARCHAR" column="password"/>
        <result property="address" jdbcType="VARCHAR" column="address"/>
        <result property="company" jdbcType="VARCHAR" column="company"/>
        <result property="salt" jdbcType="INTEGER" column="salt"/>
        <result property="phone" jdbcType="VARCHAR" column="phone"/>
        <result property="loginTime" jdbcType="BIGINT" column="login_time"/>
        <result property="lastLoginTime" jdbcType="BIGINT" column="last_login_time"/>
        <result property="loginIp" jdbcType="VARCHAR" column="login_ip"/>
        <result property="lastLoginIp" jdbcType="VARCHAR" column="last_login_ip"/>
        <result property="loginTimes" jdbcType="INTEGER" column="login_times"/>
        <result property="errorTimes" jdbcType="INTEGER" column="error_times"/>
        <result property="state" jdbcType="TINYINT" column="state"/>
        <result property="parentId" jdbcType="BIGINT" column="parent_id"/>
        <result property="allowLoginIp" jdbcType="VARCHAR" column="allow_login_ip"/>
        <result property="code" jdbcType="VARCHAR" column="code"/>
        <result property="isJobIng" jdbcType="TINYINT" column="is_job_ing"/>
        <result property="createdBy" jdbcType="BIGINT" column="created_by"/>
        <result property="createdDate" jdbcType="BIGINT" column="created_date"/>
        <result property="modifiedBy" jdbcType="BIGINT" column="modified_by"/>
        <result property="modifiedDate" jdbcType="BIGINT" column="modified_date"/>
        <result property="status" jdbcType="TINYINT" column="status"/>
        <result property="ip" jdbcType="VARCHAR" column="ip"/>
    </resultMap>

    <resultMap id="adminOnlyDTOMap" type="com.uwallet.pay.main.model.dto.AdminOnlyDTO">
        <id property="id" jdbcType="BIGINT" column="id"/>
    </resultMap>

    <resultMap id="findListAndRoleNameByRoleId" type="com.uwallet.pay.main.model.dto.AdminOnlyDTO">
        <id property="id" jdbcType="BIGINT" column="id"/>
    </resultMap>

    <resultMap id="riskAdminDTOMap" type="com.uwallet.pay.main.model.dto.AdminDTO">
        <id property="id" jdbcType="BIGINT" column="id"/>
        <result property="userName" jdbcType="VARCHAR" column="user_name"/>
        <result property="password" jdbcType="VARCHAR" column="password"/>
        <result property="phone" jdbcType="VARCHAR" column="mobile"/>
        <result property="realName" jdbcType="VARCHAR" column="real_name"/>
        <result property="roleName" jdbcType="VARCHAR" column="roleName"/>
        <result property="roleId" jdbcType="BIGINT" column="roleId"/>
        <result property="lastLoginTime" jdbcType="BIGINT" column="last_login_time"/>
        <result property="lastLoginIp" jdbcType="VARCHAR" column="last_login_ip"/>
        <result property="loginTime" jdbcType="BIGINT" column="login_time"/>
        <result property="loginIp" jdbcType="VARCHAR" column="login_ip"/>
        <result property="loginTimes" jdbcType="INTEGER" column="login_times"/>
        <result property="state" jdbcType="TINYINT" column="state"/>
        <result property="createdBy" jdbcType="BIGINT" column="created_by"/>
        <result property="createdDate" jdbcType="BIGINT" column="created_date"/>
        <result property="modifiedBy" jdbcType="BIGINT" column="modified_by"/>
        <result property="modifiedDate" jdbcType="BIGINT" column="modified_date"/>
        <result property="status" jdbcType="TINYINT" column="status"/>
        <result property="ip" jdbcType="VARCHAR" column="ip"/>
    </resultMap>

    <resultMap id="riskAdminByUsernameDTOMap" type="com.uwallet.pay.main.model.dto.AdminDTO">
        <id property="id" jdbcType="BIGINT" column="id"/>
        <collection property="adminRoleDTO" column="{adminId=id}"
                    select="com.uwallet.pay.main.dao.AdminRoleDAO.selectOneByAdminIdDTO">
        </collection>
    </resultMap>

    <resultMap id="adminAndRoleDTOMap" type="com.uwallet.pay.main.model.dto.AdminOnlyDTO">
        <id property="id" jdbcType="BIGINT" column="id"/>
        <result property="userName" jdbcType="VARCHAR" column="user_name"/>
        <result property="realName" jdbcType="VARCHAR" column="real_name"/>
        <result property="password" jdbcType="VARCHAR" column="password"/>
        <result property="phone" jdbcType="VARCHAR" column="phone"/>
        <result property="lastLoginTime" jdbcType="BIGINT" column="last_login_time"/>
        <result property="lastLoginIp" jdbcType="VARCHAR" column="last_login_ip"/>
        <result property="loginTime" jdbcType="BIGINT" column="login_time"/>
        <result property="loginIp" jdbcType="VARCHAR" column="login_ip"/>
        <result property="loginTimes" jdbcType="INTEGER" column="login_times"/>
        <result property="state" jdbcType="TINYINT" column="state"/>
        <result property="createdBy" jdbcType="BIGINT" column="created_by"/>
        <result property="createdDate" jdbcType="BIGINT" column="created_date"/>
        <result property="modifiedBy" jdbcType="BIGINT" column="modified_by"/>
        <result property="modifiedDate" jdbcType="BIGINT" column="modified_date"/>
        <result property="status" jdbcType="TINYINT" column="status"/>
        <result property="isJobIng" jdbcType="TINYINT" column="is_job_ing"/>
        <result property="ip" jdbcType="VARCHAR" column="ip"/>
        <collection property="adminRoleDTO" column="{adminId=id}"
                    select="com.uwallet.pay.main.dao.AdminRoleDAO.selectByAdminIdDTO">
        </collection>
    </resultMap>

    <resultMap id="adminDTOMap" type="com.uwallet.pay.main.model.dto.AdminDTO">
        <id property="id" jdbcType="BIGINT" column="id"/>
        <result property="userName" jdbcType="VARCHAR" column="user_name"/>
        <result property="realName" jdbcType="VARCHAR" column="real_name"/>
        <result property="password" jdbcType="VARCHAR" column="password"/>
        <result property="address" jdbcType="VARCHAR" column="address"/>
        <result property="company" jdbcType="VARCHAR" column="company"/>
        <result property="salt" jdbcType="INTEGER" column="salt"/>
        <result property="phone" jdbcType="VARCHAR" column="phone"/>
        <result property="loginTime" jdbcType="BIGINT" column="login_time"/>
        <result property="lastLoginTime" jdbcType="BIGINT" column="last_login_time"/>
        <result property="loginIp" jdbcType="VARCHAR" column="login_ip"/>
        <result property="lastLoginIp" jdbcType="VARCHAR" column="last_login_ip"/>
        <result property="loginTimes" jdbcType="INTEGER" column="login_times"/>
        <result property="errorTimes" jdbcType="INTEGER" column="error_times"/>
        <result property="state" jdbcType="TINYINT" column="state"/>
        <result property="parentId" jdbcType="BIGINT" column="parent_id"/>
        <result property="allowLoginIp" jdbcType="VARCHAR" column="allow_login_ip"/>
        <result property="code" jdbcType="VARCHAR" column="code"/>
        <result property="isJobIng" jdbcType="TINYINT" column="is_job_ing"/>
        <result property="createdBy" jdbcType="BIGINT" column="created_by"/>
        <result property="createdDate" jdbcType="BIGINT" column="created_date"/>
        <result property="modifiedBy" jdbcType="BIGINT" column="modified_by"/>
        <result property="modifiedDate" jdbcType="BIGINT" column="modified_date"/>
        <result property="status" jdbcType="TINYINT" column="status"/>
        <result property="ip" jdbcType="VARCHAR" column="ip"/>
    </resultMap>

    <resultMap id="AdminWithBorrowVerifyCountDTOMap"
               type="com.uwallet.pay.main.model.dto.AdminWithBorrowVerifyCountDTO">
        <id property="id" jdbcType="BIGINT" column="id"/>
        <result property="userName" jdbcType="VARCHAR" column="user_name"/>
        <result property="realName" jdbcType="VARCHAR" column="real_name"/>
        <result property="password" jdbcType="VARCHAR" column="password"/>
        <result property="address" jdbcType="VARCHAR" column="address"/>
        <result property="company" jdbcType="VARCHAR" column="company"/>
        <result property="salt" jdbcType="INTEGER" column="salt"/>
        <result property="phone" jdbcType="VARCHAR" column="phone"/>
        <result property="loginTime" jdbcType="BIGINT" column="login_time"/>
        <result property="lastLoginTime" jdbcType="BIGINT" column="last_login_time"/>
        <result property="loginIp" jdbcType="VARCHAR" column="login_ip"/>
        <result property="lastLoginIp" jdbcType="VARCHAR" column="last_login_ip"/>
        <result property="loginTimes" jdbcType="INTEGER" column="login_times"/>
        <result property="errorTimes" jdbcType="INTEGER" column="error_times"/>
        <result property="state" jdbcType="TINYINT" column="state"/>
        <result property="parentId" jdbcType="BIGINT" column="parent_id"/>
        <result property="allowLoginIp" jdbcType="VARCHAR" column="allow_login_ip"/>
        <result property="code" jdbcType="VARCHAR" column="code"/>
        <result property="isJobIng" jdbcType="TINYINT" column="is_job_ing"/>
        <result property="createdBy" jdbcType="BIGINT" column="created_by"/>
        <result property="createdDate" jdbcType="BIGINT" column="created_date"/>
        <result property="modifiedBy" jdbcType="BIGINT" column="modified_by"/>
        <result property="modifiedDate" jdbcType="BIGINT" column="modified_date"/>
        <result property="status" jdbcType="TINYINT" column="status"/>
        <result property="ip" jdbcType="VARCHAR" column="ip"/>
        <association property="awaitApprovalCount" column="{adminId=id}"
                     select="com.uwallet.pay.main.dao.BorrowVerifyDAO.awaitApprovalCount"/>
        <association property="alreadyApprovalCount" column="{adminId=id}"
                     select="com.uwallet.pay.main.dao.BorrowVerifyDAO.alreadyApprovalCount"/>
    </resultMap>


    <resultMap id="AdminAndRoleAndRepayDTOMap" type="com.uwallet.pay.main.model.dto.AdminAndRoleDTO">
        <id property="id" jdbcType="BIGINT" column="id"/>
        <result property="userName" jdbcType="VARCHAR" column="user_name"/>
        <result property="roleName" jdbcType="VARCHAR" column="name"/>
        <result property="parentId" jdbcType="VARCHAR" column="parent_id"/>
        <result property="isJobIng" jdbcType="VARCHAR" column="is_job_ing"/>
    </resultMap>

    <insert id="insert" parameterType="com.uwallet.pay.main.model.entity.Admin">
    INSERT INTO u_admin (
        `id`,
        `user_name`,
        `real_name`,
        `password`,
        `address`,
        `company`,
        `salt`,
        `phone`,
        `login_time`,
        `last_login_time`,
        `login_ip`,
        `last_login_ip`,
        `state`,
        `parent_id`,
        `allow_login_ip`,
        `code`,
        `is_job_ing`,
        `created_by`,
        `created_date`,
        `modified_by`,
        `modified_date`,
        `status`,
        `ip`
    ) VALUES (
        #{id},
        #{userName},
        #{realName},
        #{password},
        #{address},
        #{company},
        #{salt},
        #{phone},
        #{loginTime},
        #{lastLoginTime},
        #{loginIp},
        #{lastLoginIp},
        #{state},
        #{parentId},
        #{allowLoginIp},
        #{code},
        #{isJobIng},
        #{createdBy},
        #{createdDate},
        #{modifiedBy},
        #{modifiedDate},
        #{status},
        #{ip}
    )
  </insert>

    <insert id="insertList" parameterType="List">
        INSERT INTO u_admin (
        `id`,
        `user_name`,
        `real_name`,
        `password`,
        `address`,
        `company`,
        `salt`,
        `phone`,
        `login_time`,
        `last_login_time`,
        `login_ip`,
        `last_login_ip`,
        `login_times`,
        `error_times`,
        `state`,
        `parent_id`,
        `allow_login_ip`,
        `code`,
        `is_job_ing`,
        `created_by`,
        `created_date`,
        `modified_by`,
        `modified_date`,
        `status`,
        `ip`
        ) VALUES
        <foreach collection="list" item="data" separator=",">
            (
            #{data.id},
            #{data.userName},
            #{data.realName},
            #{data.password},
            #{data.address},
            #{data.company},
            #{data.salt},
            #{data.phone},
            #{data.loginTime},
            #{data.lastLoginTime},
            #{data.loginIp},
            #{data.lastLoginIp},
            #{data.loginTimes},
            #{data.errorTimes},
            #{data.state},
            #{data.parentId},
            #{data.allowLoginIp},
            #{data.code},
            #{data.isJobIng},
            #{data.createdBy},
            #{data.createdDate},
            #{data.modifiedBy},
            #{data.modifiedDate},
            #{data.status},
            #{data.ip}
            )
        </foreach>
    </insert>

    <update id="update" parameterType="com.uwallet.pay.main.model.entity.Admin">
        UPDATE u_admin
        <set>
            <if test="id != null">
                `id`=#{id},
            </if>
            <if test="userName != null">
                `user_name`=#{userName},
            </if>
            <if test="realName != null">
                `real_name`=#{realName},
            </if>
            <if test="password != null">
                `password`=#{password},
            </if>
            <if test="address != null">
                `address`=#{address},
            </if>
            <if test="company != null">
                `company`=#{company},
            </if>
            <if test="salt != null">
                `salt`=#{salt},
            </if>
            <if test="phone != null">
                `phone`=#{phone},
            </if>
            <if test="loginTime != null">
                `login_time`=#{loginTime},
            </if>
            <if test="lastLoginTime != null">
                `last_login_time`=#{lastLoginTime},
            </if>
            <if test="loginIp != null">
                `login_ip`=#{loginIp},
            </if>
            <if test="lastLoginIp != null">
                `last_login_ip`=#{lastLoginIp},
            </if>
            <if test="loginTimes != null">
                `login_times`=#{loginTimes},
            </if>
            <if test="errorTimes != null">
                `error_times`=#{errorTimes},
            </if>
            <if test="state != null">
                `state`=#{state},
            </if>
            <if test="parentId != null">
                `parent_id`=#{parentId},
            </if>
            <if test="allowLoginIp != null">
                `allow_login_ip`=#{allowLoginIp},
            </if>
            <if test="code != null">
                `code`=#{code},
            </if>
            <if test="isJobIng != null">
                `is_job_ing`=#{isJobIng},
            </if>
            <if test="createdBy != null">
                `created_by`=#{createdBy},
            </if>
            <if test="createdDate != null">
                `created_date`=#{createdDate},
            </if>
            <if test="modifiedBy != null">
                `modified_by`=#{modifiedBy},
            </if>
            <if test="modifiedDate != null">
                `modified_date`=#{modifiedDate},
            </if>
            <if test="status != null">
                `status`=#{status},
            </if>
            <if test="ip != null">
                `ip`=#{ip},
            </if>
        </set>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <choose>
                <when test="status != null ">AND status = #{status.value}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            AND id = #{id}
        </trim>
    </update>

    <update id="delete" parameterType="Map">
      UPDATE u_admin
      SET `status`=0,`modified_by`=#{modifiedBy},`modified_date`=#{modifiedDate}
      WHERE id = #{id}
  </update>

    <delete id="pdelete" parameterType="Map">
      DELETE FROM u_admin
      WHERE id = #{id}
  </delete>

    <select id="count" parameterType="Map" resultType="Integer">
        <![CDATA[
            SELECT COUNT(DISTINCT id) FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND (`parent_id`=#{parentId} OR `id`=#{parentId})
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">And status = #{status}</when>
                <otherwise><![CDATA[And status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
    </select>

    <select id="selectOne" parameterType="Map" resultMap="adminMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND `parent_id`=#{parentId}
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        LIMIT 1
    </select>

    <select id="selectOneDTO" parameterType="Map" resultMap="adminDTOMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND `parent_id`=#{parentId}
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        LIMIT 1
    </select>

    <select id="select" parameterType="Map" resultMap="adminMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND `parent_id`=#{parentId}
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        <if test="scs != null and scs.size() > 0">
            ORDER BY
            <foreach collection="scs" item="sc" separator=",">
                ${sc.field} ${sc.order}
            </foreach>
        </if>
        <if test="pc != null">
            LIMIT ${pc.startIndex}, ${pc.pageSize}
        </if>
    </select>

    <select id="selectDTO" parameterType="Map" resultMap="adminDTOMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND `parent_id`=#{parentId}
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        <if test="scs != null and scs.size() > 0">
            ORDER BY
            <foreach collection="scs" item="sc" separator=",">
                ${sc.field} ${sc.order}
            </foreach>
        </if>
        <if test="pc != null">
            LIMIT ${pc.startIndex}, ${pc.pageSize}
        </if>
    </select>

    <select id="selectMap" parameterType="Map" resultType="Map">
        SELECT
        <foreach collection="columns" item="cname" separator="," open="`" close="`">
            ${cname}
        </foreach>
        FROM u_admin
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND `parent_id`=#{parentId}
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        <if test="scs != null and scs.size() > 0">
            ORDER BY
            <foreach collection="scs" item="sc" separator=",">
                ${sc.field} ${sc.order}
            </foreach>
        </if>
        <if test="pc != null">
            LIMIT ${pc.startIndex}, ${pc.pageSize}
        </if>
    </select>

    <!--统计相关查询-->
    <select id="groupCount" parameterType="Map" resultType="Map">
        <![CDATA[
            SELECT ${group} AS `group`, COUNT(DISTINCT id) AS `count` FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND `parent_id`=#{parentId}
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        GROUP BY `group`
        ORDER BY `group` ASC
    </select>

    <select id="sum" parameterType="Map" resultType="Double">
        <![CDATA[
            SELECT IFNULL(SUM(${sumfield}),0) AS `sum` FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND `parent_id`=#{parentId}
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
    </select>

    <select id="groupSum" parameterType="Map" resultType="Map">
        <![CDATA[
            SELECT ${group} AS `group`, IFNULL(SUM(${sumfield}),0) AS `sum` FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND `parent_id`=#{parentId}
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        GROUP BY `group`
        ORDER BY `group` ASC
    </select>

    <select id="selectAdminWithBorrowVerifyCountDTO" parameterType="Map" resultMap="AdminWithBorrowVerifyCountDTOMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name` like concat('%',#{userName},'%')
            </if>
            <if test="realName != null">
                AND `real_name` like concat('%',#{realName},'%')
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND (`parent_id`=#{parentId} OR `id`=#{parentId})
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
            <if test="roleId != null">
                AND (`id` IN (SELECT `admin_id` FROM u_admin_role WHERE `role_id`=#{roleId}) OR `parent_id` IN (SELECT
                `admin_id` FROM u_admin_role WHERE `role_id`=#{roleId}))
            </if>
            <if test="groupMembersRoleId != null">
                AND EXISTS (SELECT * FROM u_admin_role WHERE (`role_id`=#{groupMembersRoleId} OR `role_id`=#{groupLeaderRoleId}) AND u_admin_role.`admin_id`=u_admin.`id`)
            </if>
        </trim>
        <if test="scs != null and scs.size() > 0">
            ORDER BY
            <foreach collection="scs" item="sc" separator=",">
                ${sc.field} ${sc.order}
            </foreach>
        </if>
        <if test="pc != null">
            LIMIT ${pc.startIndex}, ${pc.pageSize}
        </if>

    </select>

    <select id="likeCount" parameterType="Map" resultType="Integer">
        <![CDATA[
            SELECT COUNT(DISTINCT id) FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name` like concat('%',#{userName},'%')
            </if>
            <if test="realName != null">
                AND `real_name` like concat('%',#{realName},'%')
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND (`parent_id`=#{parentId} OR `id`=#{parentId})
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">And status = #{status}</when>
                <otherwise><![CDATA[And status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
    </select>

    <select id="selectAdminWithBorrowVerifyCount" parameterType="Map" resultType="java.lang.Integer">
        <![CDATA[
            SELECT COUNT(DISTINCT id) FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name` like concat('%',#{userName},'%')
            </if>
            <if test="realName != null">
                AND `real_name` like concat('%',#{realName},'%')
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="address != null">
                AND `address`=#{address}
            </if>
            <if test="company != null">
                AND `company`=#{company}
            </if>
            <if test="salt != null">
                AND `salt`=#{salt}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="errorTimes != null">
                AND `error_times`=#{errorTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="parentId != null">
                AND (`parent_id`=#{parentId} OR `id`=#{parentId})
            </if>
            <if test="allowLoginIp != null">
                AND `allow_login_ip`=#{allowLoginIp}
            </if>
            <if test="code != null">
                AND `code`=#{code}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
            <if test="roleId != null">
                AND (`id` IN (SELECT `admin_id` FROM u_admin_role WHERE `role_id`=#{roleId}) OR `parent_id` IN (SELECT
                `admin_id` FROM u_admin_role WHERE `role_id`=#{roleId}))
            </if>
            <if test="groupMembersRoleId != null">
                AND EXISTS (SELECT * FROM u_admin_role WHERE (`role_id`=#{groupMembersRoleId} OR `role_id`=#{groupLeaderRoleId}) AND u_admin_role.`admin_id`=u_admin.`id`)
            </if>
        </trim>
    </select>

    <select id="selectByParentId" resultMap="adminDTOMap">
        select * from u_admin
        where `is_job_ing`=#{isJobIng} and `parent_id`=#{parentId} and `state`=1 and `status`>0 and `id`
        not in
        <foreach collection="adminIdList" item="datum" separator="," open="(" close=")">
            #{datum}
        </foreach>
    </select>

    <!--查询parent_id为0的数据-->
    <select id="selectAdminAndRoleAndBorrow" resultMap="AdminAndRoleAndRepayDTOMap">
        select ra.id,ra.user_name,rr.name,ra.is_job_ing
        from u_admin ra
        left join u_admin_role rar on ra.id=rar.admin_id
        LEFT JOIN u_role rr on rar.role_id=rr.id
        where ra.status>0 and rar.status>0 and rr.status>0 and
        ra.parent_id=0
        <if test="pc != null">
            LIMIT ${pc.startIndex}, ${pc.pageSize}
        </if>
    </select>

    <!-- 审批小组，根据组长id统计同一小组成员 -->
    <select id="selectAdminAndRoleCount" parameterType="Map" resultType="Integer">
        select COUNT(distinct ra.id)
        from u_admin ra
        left join u_admin_role rar on ra.id=rar.admin_id
        left join u_role rr on rar.role_id=rr.id
        where ra.status>0 and rar.status>0 and rr.status>0
        <trim>
            <if test="isJobIng!=null">
                and ra.is_job_ing=#{isJobIng}
            </if>
            <if test="userName!=null">
                and ra.user_name=#{userName}
            </if>
            <if test="id != null">
                and ( ra.parent_id=#{id} or ra.id=#{id} )
            </if>
        </trim>
    </select>
    <!--根据条件查询四个表的数据-->
    <select id="selectAdminAndRoleAndBorrowById" resultMap="AdminAndRoleAndRepayDTOMap">
        select ra.id,ra.user_name,rr.name,ra.is_job_ing
        from u_admin ra
        left join u_admin_role rar on ra.id=rar.admin_id
        left join u_role rr on rar.role_id=rr.id
        where ra.status>0 and rar.status>0 and rr.status>0
        <trim>
            <if test="isJobIng!=null">
                and ra.is_job_ing=#{isJobIng}
            </if>
            <if test="userName!=null">
                and ra.user_name=#{userName}
            </if>
            <if test="id != null">
                and ( ra.parent_id=#{id} or ra.id=#{id} )
            </if>
        </trim>
        <if test="pc != null">
            LIMIT ${pc.startIndex}, ${pc.pageSize}
        </if>
    </select>

    <!--组长获取小组成员【审批工作台->待审核进件->分配进件】-->
    <select id="getTeamMemberInfo" resultType="com.uwallet.pay.main.model.dto.AdminDTO">
        SELECT
            id,
            user_name userName,
            real_name realName
        FROM
            u_admin
        WHERE
            is_job_ing = 1
        AND parent_id = #{adminId}
        AND STATUS > 0
    </select>

    <select id="findOneAndRoleName" parameterType="Map" resultMap="adminAndRoleDTOMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        LIMIT 1
    </select>
    <update id="updateLastLoginDate" parameterType="Long">
        UPDATE u_admin SET
                `last_login_time`=login_time,
                `last_login_ip` =login_ip
            where id = #{id}
    </update>
    <select id="selectOneByUsernameDTO" parameterType="Map" resultMap="riskAdminByUsernameDTOMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="roleId != null">
                AND `role_id`=#{roleId}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
    </select>
    <!-- 登陆成功返回需要的登录信息-->
    <select id="selectAdminPartOfData" parameterType="Map" resultMap="riskAdminDTOMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="roleId != null">
                AND `role_id`=#{roleId}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        LIMIT 1
    </select>
    <!--涉及到关联表可以用关联查询-->
    <select id="findListAndRoleNameByRoleId" parameterType="Map" resultMap="findListAndRoleNameByRoleId">
	select
	a.id
	from u_admin a
	LEFT JOIN u_admin_role b
	on a.id=b.admin_id
	LEFT JOIN u_role c
	on b.role_id=c.id
	and a.`status` >0 and b.`status` >0 and c.`status` >0
    WHERE c.id=#{roleId}
	</select>
    <select id="findAndRoleName" parameterType="Map" resultMap="adminOnlyDTOMap">
        <![CDATA[
            SELECT * FROM u_admin
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND `id`=#{id}
            </if>
            <if test="userName != null">
                AND `user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND `real_name`=#{realName}
            </if>
            <if test="password != null">
                AND `password`=#{password}
            </if>
            <if test="phone != null">
                AND `phone`=#{phone}
            </if>
            <if test="lastLoginTime != null">
                AND `last_login_time`=#{lastLoginTime}
            </if>
            <if test="lastLoginIp != null">
                AND `last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTime != null">
                AND `login_time`=#{loginTime}
            </if>
            <if test="loginIp != null">
                AND `login_ip`=#{loginIp}
            </if>
            <if test="loginTimes != null">
                AND `login_times`=#{loginTimes}
            </if>
            <if test="state != null">
                AND `state`=#{state}
            </if>
            <if test="createdBy != null">
                AND `created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND `created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND `modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND `modified_date`=#{modifiedDate}
            </if>
            <choose>
                <when test="status != null">AND status = #{status}</when>
                <otherwise><![CDATA[AND status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND `ip`=#{ip}
            </if>
        </trim>
        <if test="scs != null and scs.size() > 0">
            ORDER BY
            <foreach collection="scs" item="sc" separator=",">
                ${sc.field} ${sc.order}
            </foreach>
        </if>
        <if test="pc != null">
            LIMIT ${pc.startIndex}, ${pc.pageSize}
        </if>
    </select>

    <select id="countList" parameterType="Map" resultType="Integer">
        <![CDATA[
            SELECT COUNT(DISTINCT a.id) FROM u_admin a
            LEFT JOIN u_admin_role b on a.id=b.admin_id and b.`status` >0
            LEFT JOIN u_role c on b.role_id=c.id and c.`status` >0
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND a.`id`=#{id}
            </if>
            <if test="userName != null">
                AND a.`user_name` like concat('%',#{userName},'%')
            </if>
            <if test="roleId != null">
                AND c.`id`=#{roleId}
            </if>
            <if test="realName != null">
                AND a.`real_name` like concat('%',#{realName},'%')
            </if>
            <if test="password != null">
                AND a.`password`=#{password}
            </if>
            <if test="phone != null">
                AND a.`phone`=#{phone}
            </if>
            <if test="lastLoginTime != null">
                AND a.`last_login_time`=#{lastLoginTime}
            </if>
            <if test="lastLoginIp != null">
                AND a.`last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTime != null">
                AND a.`login_time`=#{loginTime}
            </if>
            <if test="loginIp != null">
                AND a.`login_ip`=#{loginIp}
            </if>
            <if test="loginTimes != null">
                AND a.`login_times`=#{loginTimes}
            </if>
            <if test="state != null">
                AND a.`state`=#{state}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND a.`created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND a.`created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND a.`modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND a.`modified_date`=#{modifiedDate}
            </if>
            AND c.id not in(3475387659080663010,3475387659080663020,3475387659080663030,3475387659080663040)
            <choose>
                <when test="status != null">AND a.status = #{status}</when>
                <otherwise><![CDATA[AND a.status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND a.`ip`=#{ip}
            </if>
        </trim>
    </select>

    <select id="findListAndRoleName" parameterType="Map" resultMap="adminOnlyDTOMap">
        <![CDATA[
            SELECT DISTINCT a.id FROM u_admin a
            LEFT JOIN u_admin_role b on a.id=b.admin_id and b.`status` >0
            LEFT JOIN u_role c on b.role_id=c.id and c.`status` >0
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND a.`id`=#{id}
            </if>
            <if test="userName != null">
                AND a.`user_name` like concat('%',#{userName},'%')
            </if>
            <if test="roleId != null">
                AND c.`id`=#{roleId}
            </if>
            <if test="realName != null">
                AND a.`real_name` like concat('%',#{realName},'%')
            </if>
            <if test="password != null">
                AND a.`password`=#{password}
            </if>
            <if test="phone != null">
                AND a.`phone`=#{phone}
            </if>
            <if test="lastLoginTime != null">
                AND a.`last_login_time`=#{lastLoginTime}
            </if>
            <if test="lastLoginIp != null">
                AND a.`last_login_ip`=#{lastLoginIp}
            </if>
            <if test="loginTime != null">
                AND a.`login_time`=#{loginTime}
            </if>
            <if test="loginIp != null">
                AND a.`login_ip`=#{loginIp}
            </if>
            <if test="loginTimes != null">
                AND a.`login_times`=#{loginTimes}
            </if>
            <if test="state != null">
                AND a.`state`=#{state}
            </if>
            <if test="isJobIng != null">
                AND `is_job_ing`=#{isJobIng}
            </if>
            <if test="createdBy != null">
                AND a.`created_by`=#{createdBy}
            </if>
            <if test="start != null and end != null">
                AND a.`created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND a.`modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND a.`modified_date`=#{modifiedDate}
            </if>
            AND c.id not in(3475387659080663010,3475387659080663020,3475387659080663030,3475387659080663040)
            <choose>
                <when test="status != null">AND a.status = #{status}</when>
                <otherwise><![CDATA[AND a.status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND a.`ip`=#{ip}
            </if>
        </trim>
        <if test="scs != null and scs.size() > 0">
            ORDER BY
            <foreach collection="scs" item="sc" separator=",">
                a.${sc.field} ${sc.order}
            </foreach>
        </if>
        <if test="pc != null">
            LIMIT ${pc.startIndex}, ${pc.pageSize}
        </if>
    </select>

    <!-- 登陆成功返回需要的登录信息-->
    <select id="selectRoleName" parameterType="Map" resultMap="riskAdminDTOMap">
        <![CDATA[
            SELECT c.name as roleName,c.id as roleId FROM u_admin a
            LEFT JOIN u_admin_role b
            on a.id=b.admin_id and b.`status`>0
            left JOIN u_role c
            on b.role_id=c.id and c.`status`>0
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND a.`id`=#{id}
            </if>
            <if test="userName != null">
                AND  a.`user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND a.`real_name`=#{realName}
            </if>
            <if test="password != null">
                AND a.`password`=#{password}
            </if>
            <if test="phone != null">
                AND a.`phone`=#{phone}
            </if>
            <if test="name != null">
                AND a.`name`=#{name}
            </if>
            <if test="state != null">
                AND a.`state`=#{state}
            </if>
            <if test="remark != null">
                AND a.`remark`=#{remark}
            </if>
            <if test="isJobIng != null">
                AND a.`is_job_ing`=#{isJobIng}
            </if>
            <if test="language != null">
                AND a.`language`=#{language}
            </if>
            <if test="createdBy != null">
                AND a.`created_by`=#{createdBy}
            </if>
            <if test="start != null  and  end != null">
                AND a.`created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND a.`modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND a.`modified_date`=#{modifiedDate}
            </if>
            <if test="loginTimes != null">
                AND a.`login_times`=#{loginTimes}
            </if>
            <if test="loginErrCnt != null">
                AND a.`login_err_cnt`=#{loginErrCnt}
            </if>
            <choose>
                <when test="status !=null">AND a.`status` = #{status}</when>
                <otherwise><![CDATA[AND a.status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND a.`ip`=#{ip}
            </if>
        </trim>
    </select>
    <!-- 根据角色id查询管理员-->
    <select id="selectAdminByRoleId" parameterType="Map" resultMap="riskAdminDTOMap">
        <![CDATA[
            select a.user_name,c.`name` from u_admin a
            LEFT JOIN u_admin_role b
            on a.id =b.admin_id and b.`status`>0
            LEFT JOIN u_role c
            on b.role_id=c.id and c.`status`>0
        ]]>
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            <if test="id != null">
                AND a.`id`=#{id}
            </if>
            <if test="roleId != null">
                AND c.`id`=#{roleId}
            </if>
            <if test="userName != null">
                AND  a.`user_name`=#{userName}
            </if>
            <if test="realName != null">
                AND a.`real_name`=#{realName}
            </if>
            <if test="password != null">
                AND a.`password`=#{password}
            </if>
            <if test="phone != null">
                AND a.`phone`=#{phone}
            </if>
            <if test="name != null">
                AND a.`name`=#{name}
            </if>
            <if test="state != null">
                AND a.`state`=#{state}
            </if>
            <if test="remark != null">
                AND a.`remark`=#{remark}
            </if>
            <if test="isJobIng != null">
                AND a.`is_job_ing`=#{isJobIng}
            </if>
            <if test="language != null">
                AND a.`language`=#{language}
            </if>
            <if test="createdBy != null">
                AND a.`created_by`=#{createdBy}
            </if>
            <if test="start != null  and  end != null">
                AND a.`created_date` BETWEEN #{start} AND #{ end}
            </if>
            <if test="modifiedBy != null">
                AND a.`modified_by`=#{modifiedBy}
            </if>
            <if test="modifiedDate != null">
                AND a.`modified_date`=#{modifiedDate}
            </if>
            <if test="loginTimes != null">
                AND a.`login_times`=#{loginTimes}
            </if>
            <if test="loginErrCnt != null">
                AND a.`login_err_cnt`=#{loginErrCnt}
            </if>
            <choose>
                <when test="status !=null">AND a.`status` = #{status}</when>
                <otherwise><![CDATA[AND a.status > 0]]></otherwise>
            </choose>
            <if test="ip != null">
                AND a.`ip`=#{ip}
            </if>
        </trim>
    </select>

    <select id="selectisJobIngCount" parameterType="Map" resultType="int">
     SELECT COUNT(DISTINCT id) FROM u_admin WHERE id=#{id} OR parent_id=#{id} and status>0 and is_job_ing=1
    </select>

    <!--查询组长和所对应的组员的所有的条数-->
    <select id="returnResultOneCount" parameterType="Map" resultType="Map">
        SELECT process_id,count(DISTINCT id) as num FROM `u_borrow_verify`
        where admin_id in (select id from u_admin where parent_id=#{adminId} or id =#{adminId} and status>0) and status>0
        AND (result=1 or result=2 or result=3) group by process_id
    </select>

    <!--查询组长和所对应的组员的所有的条数-->
    <select id="returnResultZeroCount" parameterType="Map" resultType="Map">
        SELECT process_id,count(DISTINCT id) as num FROM `u_borrow_verify`
        where admin_id in (select id from u_admin where parent_id=#{adminId} or id =#{adminId} and status>0) and status>0
        AND result=0 group by process_id
    </select>

    <!--查询单条组长和所对应的组员的所有的条数-->
    <select id="returnOnceResultOneCount" parameterType="Map" resultType="Map">
        SELECT process_id,count(DISTINCT id) as num FROM `u_borrow_verify`
        where admin_id=#{adminId} and status>0
        AND (result=1 or result=2 or result=3) group by process_id
    </select>

    <!--查询单条组长和所对应的组员的所有的条数-->
    <select id="returnOnceResultZeroCount" parameterType="Map" resultType="Map">
        SELECT process_id,count(DISTINCT id) as num FROM `u_borrow_verify`
        where admin_id=#{adminId}  and status>0
        AND result=0 group by process_id
    </select>

<!--  通过组长角色id查询在职组长  -->
    <select id="findTheAdministratorByRole" parameterType="java.util.List" resultType="com.uwallet.pay.main.model.dto.AdminDTO">
        SELECT
        A.`id`,
        A.`user_name`,
        A.`real_name`,
        A.`password`,
        A.`address`,
        A.`company`,
        A.`salt`,
        A.`phone`,
        A.`login_time`,
        A.`last_login_time`,
        A.`login_ip`,
        A.`last_login_ip`,
        A.`state`,
        A.`parent_id`,
        A.`allow_login_ip`,
        A.`code`,
        A.`is_job_ing`,
        A.`created_by`,
        A.`created_date`,
        A.`modified_by`,
        A.`modified_date`,
        A.`status`,
        A.`ip`
        FROM u_admin A
        LEFT JOIN u_admin_role AR ON A.id=AR.admin_id
        WHERE A.status>0
        AND AR.status>0
        AND A.state=1
        AND A.is_job_ing=1
        AND AR.role_id IN
        <foreach collection="list" item="data" open="(" separator="," close=")">
            #{data}
        </foreach>
    </select>
</mapper>
